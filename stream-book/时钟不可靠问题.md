时钟非常重要，许多应用都依赖时钟。

- 某个请求是否超时了？
- 某个服务的 P99 是多少？
- 过去五分钟，服务平均每秒处理多少查询？
- 某篇文章是什么时候发表的？
- 什么时候发送邮件？
- 缓存何时过期？
- 日志中错误消息的时间戳是多少？

前三个关于时间间隔，后四个关于某个时间点。

由于在分布式系统中，每台机器都有自己的本地时间，这些时间是不精确不同步的。常用的办法是通过 NTP(network time protocol)来调整本地时间。

### 单调时钟和墙上时钟

现代计算机内部至少有两种不同时钟，一种是墙上时钟，一种是单调时钟。本质上它们服务于不同的目的。我们可以通过 man clock_gettime 了解该系统调用。该系统调用的参数 clock_id 可以被设置为五种值。设置为 CLOCK_REALTIME 就是返回墙上时钟。设置为 CLOCK_MONOTONIC 就是返回单调时钟。

- 墙上时钟返回当前的日期与时间，比如 java 中的 System.currentTimeMillis()。墙上时间可以和 NTP 同步，但是会出现「回到过去」现象。
- 单调时钟保证它们总是向前，不会出现时钟回拨现象。比如 java 中的 System.nanoTime()。需要注意，单调时钟的绝对值没什么意义，因此比较不同机器上的单调时钟也没有意义，他们的基准不同。
