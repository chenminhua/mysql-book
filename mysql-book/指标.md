# 指标

## 统计

QPS:每秒请求数
TPS:每秒事务处理数  
SHOW GLOBAL STATUS LIKE 'com_commit'\G; 只显示显式的提交和回滚
show global status like 'com_rollback'\G;
show global status like 'handler_commit'\G; 显示显式的和隐式的提交和回滚
show global status like 'handler_rollback'\G;

### qps 与 tps

com_commit = show global status like 'com_commit';
com_rollback = show global status like 'com_rollback';
uptime = show global status like 'uptime';
questions = show global status like 'questions';
qps = questions / uptime;
tps=(com_commit + com_rollback) / uptime;
方法二
show global status where variable_name in('com_select','com_insert','com_delete','com_update');

### innodb buffer 命中率

Innodb_buffer_pool_read_requests 表示 read 请求的次数，Innodb_buffer_pool_reads 表示从物理磁盘中读取数据的请求次数，所以 innodb buffer 的 read 命中率就可以这样得到：（Innodb_buffer_pool_read_requests - Innodb_buffer_pool_reads） / Innodb_buffer_pool_read_requests 一般来讲这个命中率不会低于 99%，如果低于这个值的话就要考虑加大 innodb buffer pool。
show variables like "%innodb_buffer_pool_size%"

### 锁的指标

show global status like '%lock%';
Table_locks_waited/Table_locks_immediate=0.3% 如果这个比值比较大的话，说明表锁造成的阻塞比较严重
Innodb_row_lock_waits innodb 行锁，太大可能是间隙锁造成的

### Query Cache 命中率

我们不开 query cache
show variables like '%cache%';
mysql> show status like 'Qcache%';
Query_cache_hits = (Qcahce_hits / (Qcache_hits + Qcache_inserts )) \* 100%;

### Table Cache 状态量

mysql> show global status like 'open%';
比较 open_tables 与 opend_tables 值
Open_tables ：代表当前打开表的数量。
Opened_tables：代表自从 MySQL 启动后，打开表的数量。
对于 innodb 存储引擎，开启表的独立表空间（innodb_file_per_table）打开 1 张表只需要 1 个文件描述符（一个.ibd 文件）。
Open_files ：代表当前打开的文件。对应存储引擎（如：innodb）使用存储引擎自己内部函数打开的话，这个值是不会增加的。
Opened_files：代表使用 MySQL 的 my_open()函数打开过的文件数。如果不是使用这个函数打开文件的话，这个值是不会增加的。

### Thread Cache 命中率

mysql> show global status like 'Thread%';
mysql> show global status like 'Connections';
Thread_cache_hits = (1 - Threads_created / connections ) \* 100%

### 复制延时量

mysql > show slave status
查看延时时间

### Tmp Table 状况(临时表状况)

mysql > show status like '%Created_tmp%';
Created_tmp_disk_tables/Created_tmp_tables 比值最好不要超过 10%，如果 Created_tmp_tables 值比较大，可能是排序句子过多或者是连接句子不够优化

### Binlog Cache 使用状况

mysql > show status like 'Binlog_cache%';
如果 Binlog_cache_disk_use 值不为 0 ，可能需要调大 binlog_cache_size 大小

### Innodb_log_waits 量

mysql > show status like 'innodb_log_waits';
Innodb_log_waits 值不等于 0 的话，表明 innodb log buffer 因为空间不足而等待

比如命令：

> #show global status;
> 虽然可以使用：
> #show global status like %...%;
> 来过滤，但是对应长长的 list，每一项都代表什么意思，还是有必要弄清楚。

### 表大小

SELECT TABLE_NAME, INDEX_LENGTH, DATA_LENGTH FROM information_schema.TABLES WHERE TABLE_NAME = 'material_lot';
